<div class="panel panel-primary panel-primary-wide">
   <div class="panel-heading">
    <h2><%= link_to 'Manage Locations', locations_path %> > <%= @location.placename %></h2>
   </div>
   <div class="panel-body">
      <div class="">
        <div class="row row-big-space">
          <div class=" col-md-6 ">
          <%= image_tag(@location.image.url(:medium), class:"img-responsive img-rounded center-block" )%>
          </div>
          <div class="col-md-6">

            <form action="#" onsubmit="showAddress(this.address.value); return false">
              <p>
                <input type="text" style="width:350px" name="address" value="West Hartford"/>
                <input type="submit" value="Search" />
              </p>
              <div style='width: 400px;' class = "center-block">
              <div id="map" style='width: 400px; height: 300px;'></div>
            </div>
            </form>
            
          </div>
        </div>
      </div>
        <% if @events.length == 0 %>
          <div class="row row-big-space ">
        <% else %>
          <div class="row row-big-space row-bottom-border ">
        <% end %>
            <div class=" col-md-6 text-center ">
            </div>
            <div class=" col-md-6 ">
              <%= link_to 'Edit Location', edit_location_path(@location), class: "btn btn-primary" %> |
              <%= link_to '+ Add Event', new_location_event_path(@location), class: "btn btn-success" %> | 
              <a href='#' class="btn btn-primary">Past Events</a>
            </div>
          </div>
        <% if @events.length == 0 %>
          <div class="row row-big-space">
            <div class=" col-md-6 text-center"> 
              <h4>There are no upcoming events scheduled</h4>
            </div>
          </div>
        <% end %>
        <% @events.each do |event| %>
        <div class="row row-big-space row-bottom-border">
          <div class=" col-md-2 text-center">   
              <div><h3><%= event.eventstart.in_time_zone('Eastern Time (US & Canada)').strftime("%a") %></h3></div>
              <div><h1><%= event.eventstart.in_time_zone('Eastern Time (US & Canada)').strftime("%d") %></h1></div>
              <div><h3><%= event.eventstart.in_time_zone('Eastern Time (US & Canada)').strftime("%b") %></h3></div>
          </div>
          <div class=" col-md-10 "> 
              <div>
                <div>
                  <h3 class="side-by-side-left"><%= event.eventstart.in_time_zone('Eastern Time (US & Canada)').strftime("%I:%M %p") %> - <%= event.eventend.in_time_zone('Eastern Time (US & Canada)').strftime("%I:%M %p") %></h3><p class="side-by-side-right">     (Time in <%= event.eventstart.in_time_zone('Eastern Time (US & Canada)').strftime("%Z") %>)</p><%= link_to 'Edit Event', edit_location_event_path(@location,event), class: "btn btn-primary side-by-side-float-right" %> 
                </div>
                <div>
                  <%= image_tag(event.image.url(:thumb), class:"img-responsive img-circle side-by-side-left" )%>
                  <h1 class="side-by-side-right"><%= link_to event.eventname, location_event_path(@location,event) %></h1> 

                </div>
              </div>
          </div>
        </div>
        <% end %>    
   </div>
</div>



<script type="text/javascript">
  handler = Gmaps.build('Google');
  handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
    markers = handler.addMarkers(<%=raw @hash.to_json %>);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
    handler.getMap().setZoom(12);
  });

  function findLocation() {
    var address = document.getElementById('address').value;
    alert("address");
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        alert("here");
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
      } else {
        alert('Location not found: ' + status);
      }
    });
  }
  </script>
